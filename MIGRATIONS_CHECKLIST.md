# SQL Migrations Checklist

**‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞**: ‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á Apply ‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

## ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á Apply (‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö)

- [ ] **1. notifications_audit.sql**
  - ‡∏Ç‡∏ô‡∏≤‡∏î: 13 KB
  - ‡∏à‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå: ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô In-App ‡πÅ‡∏•‡∏∞ Audit Trail
  - ‡πÑ‡∏ü‡∏•‡πå: `supabase/migrations/20260204000001_notifications_audit.sql`

- [ ] **2. reservation_advanced.sql**
  - ‡∏Ç‡∏ô‡∏≤‡∏î: 21 KB
  - ‡∏à‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå: Logic ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á (‡∏Ñ‡∏∑‡∏ô‡∏Ç‡∏≠‡∏á, ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå, ‡∏î‡∏∂‡∏á‡∏Ç‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏™‡∏≠‡∏∑‡πà‡∏ô)
  - ‡πÑ‡∏ü‡∏•‡πå: `supabase/migrations/20260204000002_reservation_advanced.sql`

- [ ] **3. product_attributes.sql**
  - ‡∏Ç‡∏ô‡∏≤‡∏î: 19 KB
  - ‡∏à‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå: Dynamic Product Attributes ‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
  - ‡πÑ‡∏ü‡∏•‡πå: `supabase/migrations/20260204000003_product_attributes.sql`

- [ ] **4. smart_search.sql**
  - ‡∏Ç‡∏ô‡∏≤‡∏î: 15 KB
  - ‡∏à‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå: Smart Search + FEFO + ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Å‡∏±‡∏ô
  - ‡πÑ‡∏ü‡∏•‡πå: `supabase/migrations/20260204000004_smart_search.sql`

- [ ] **5. out_of_stock_requests.sql**
  - ‡∏Ç‡∏ô‡∏≤‡∏î: 18 KB
  - ‡∏à‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå: Out-of-Stock Request System + Purchase Orders + LINE Integration
  - ‡πÑ‡∏ü‡∏•‡πå: `supabase/migrations/20260204000005_out_of_stock_requests.sql`

- [ ] **6. po_receive_integration.sql** ‚≠ê NEW!
  - ‡∏Ç‡∏ô‡∏≤‡∏î: 22 KB
  - ‡∏à‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå: ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á PO ‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏•‡∏±‡∏á + Auto-Allocation + Traffic Light
  - ‡πÑ‡∏ü‡∏•‡πå: `supabase/migrations/20260204000006_po_receive_integration.sql`

---

## ‡∏ß‡∏¥‡∏ò‡∏µ Apply

### Option 1: ‡∏ú‡πà‡∏≤‡∏ô Supabase Dashboard (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [Supabase Dashboard](https://supabase.com/dashboard)
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Project ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
3. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **SQL Editor**
4. Copy ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ß‡∏≤‡∏á
5. ‡∏Å‡∏î **Run** ‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö

### Option 2: ‡∏ú‡πà‡∏≤‡∏ô Supabase CLI

```bash
# ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Supabase CLI (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ)
npm install -g supabase

# Login
supabase login

# Link project
supabase link --project-ref YOUR_PROJECT_REF

# Apply migrations
supabase db push
```

---

## ‡∏´‡∏•‡∏±‡∏á Apply ‡πÅ‡∏•‡πâ‡∏ß

1. ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ Error
2. ‚úÖ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Functions ‡πÉ‡∏´‡∏°‡πà
3. ‚úÖ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LINE Messaging API (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ)
4. ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° Supplier LINE Contacts
5. ‚úÖ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏ß‡∏±‡∏™‡∏î‡∏∏
6. ‚úÖ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Out-of-Stock Request
7. ‚úÖ **‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏à‡∏≤‡∏Å PO ‡πÅ‡∏•‡∏∞ Auto-Allocation** ‚≠ê

---

## ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å Migration #6

### 1. ‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏à‡∏≤‡∏Å PO
- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å PO ‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏£‡∏±‡∏ö
- ‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞ LOT, Expiry, Location
- ‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å PO ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

### 2. Auto-Allocation (FIFO)
- ‡∏ï‡∏±‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏° surgery_date (‡πÄ‡∏Ñ‡∏™‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ï‡∏±‡∏î‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤‡πÑ‡∏î‡πâ‡∏Å‡πà‡∏≠‡∏ô)
- ‡∏™‡∏£‡πâ‡∏≤‡∏á reservation_items ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

### 3. Auto Update Traffic Light
- ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏µ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤
- üü¢ ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß - ‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- üü° ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á - ‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°
- üî¥ ‡πÅ‡∏î‡∏á - ‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏´‡∏°‡∏î

### 4. Auto Notification
- ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡∏ô‡∏ï‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß
- ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ù‡πà‡∏≤‡∏¢‡∏Ñ‡∏•‡∏±‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß

---

## ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏

- ‚ö†Ô∏è **‡∏ï‡πâ‡∏≠‡∏á Apply ‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö** ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏°‡∏µ Dependencies ‡∏Å‡∏±‡∏ô
- ‚ö†Ô∏è **Backup Database ‡∏Å‡πà‡∏≠‡∏ô** (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)
- ‚ö†Ô∏è ‡πÑ‡∏ü‡∏•‡πå `20260204000000_init.sql` ‡πÅ‡∏•‡∏∞ `20260204000001_storage.sql` ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏° ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á Apply ‡πÉ‡∏´‡∏°‡πà

---

**‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î**: 4 ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2569 (‡πÄ‡∏û‡∏¥‡πà‡∏° Migration #6)
